{% extends "superadmin/superadmin_base.html" %}
{% load static %}
{% block title %}Super Admin Dashboard{% endblock %}

{% block content %}

<style>
  .modal-backdrop.show {
    opacity: 0.6 !important;
    background-color: rgba(0, 0, 0, 0.5);
  }

  .modal-content {
    border-radius: 1rem;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    padding: 1.5rem;
    border: none;
  }

  .modal .form-control {
    border-radius: 0.5rem;
    border: 1px solid #ddd;
    padding: 0.75rem;
    font-size: 0.95rem;
  }

  .modal .form-control:focus {
    border-color: #0d6efd;
    box-shadow: 0 0 0 0.15rem rgba(13, 110, 253, 0.25);
  }

  .modal-header, .modal-footer {
    border: none;
  }

  .modal-footer .btn-danger {
    background-color: transparent;
    border: none;
    color: #dc3545;
    font-size: 0.9rem;
  }

  .modal-footer .btn-danger:hover {
    background-color: rgba(220, 53, 69, 0.1);
    color: #a30000;
  }
</style>

<div class="col-md-10 container-fluid px-4 py-4">

  <h3 class="fw-bold mb-4">Manage Schools</h3>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    {% endfor %}
  {% endif %}

  <!-- Add School Form -->
  <div class="card mb-4 shadow-sm border-0">
    <div class="card-body">
      <h5 class="fw-semibold text-muted mb-3" style="font-size: 1rem;">Add School</h5>
      <form method="post" action="" class="row g-3">
        {% csrf_token %}
        <div class="col-md-4">
          <label class="form-label">Name</label>
          <input type="text" name="name" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Address</label>
          <input type="text" name="address" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label class="form-label">Email</label>
          <input type="email" name="email" class="form-control">
        </div>
        <div class="col-md-4">
          <label class="form-label">Phone Number</label>
          <input type="text" name="phone_number" class="form-control">
        </div>
        <div class="col-md-4">
          <label class="form-label">Owner Name</label>
          <input type="text" name="owner_name" class="form-control">
        </div>
        <div class="col-md-4">
          <label class="form-label">Principal Name</label>
          <input type="text" name="principal_name" class="form-control">
        </div>
        <div class="col-12 mt-2">
          <button type="submit" class="btn btn-primary w-100">Add School</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Existing Schools Table -->
  <div class="card shadow-sm border-0">
    <div class="card-body">
      <h5 class="fw-semibold text-muted mb-3" style="font-size: 1rem;">Registered Schools</h5>
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0">
          <thead class="table-light">
            <tr>
              <th>Name</th>
              <th>Address</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            {% for school in schools %}
              <tr>
                <td>{{ school.name }}</td>
                <td>{{ school.address }}</td>
                <td>
                  <button class="btn btn-sm btn-outline-primary edit-btn" 
                    data-bs-toggle="modal" 
                    data-bs-target="#editModal"
                    data-id="{{ school.id }}"
                    data-name="{{ school.name }}"
                    data-address="{{ school.address }}"
                    data-email="{{ school.email }}"
                    data-phone="{{ school.phone_number }}"
                    data-owner="{{ school.owner_name }}"
                    data-principal="{{ school.principal_name }}">
                    <i class="bi bi-pencil"></i> Edit
                  </button>
                </td>
              </tr>
            {% empty %}
              <tr>
                <td colspan="3" class="text-center text-muted">No schools available.</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1">
  <div class="modal-dialog modal-dialog-centered">
    <div class="modal-content">
      <form method="post" id="editForm">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Edit School</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" name="school_id" id="editId">
          <div class="mb-3">
            <label class="form-label">Name</label>
            <input type="text" class="form-control" name="name" id="editName" required>
          </div>
          <div class="mb-3">
            <label class="form-label">Address</label>
            <textarea class="form-control" name="address" id="editAddress" required></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" name="email" id="editEmail">
          </div>
          <div class="mb-3">
            <label class="form-label">Phone Number</label>
            <input type="text" class="form-control" name="phone_number" id="editPhone">
          </div>
          <div class="mb-3">
            <label class="form-label">Owner Name</label>
            <input type="text" class="form-control" name="owner_name" id="editOwner">
          </div>
          <div class="mb-3">
            <label class="form-label">Principal Name</label>
            <input type="text" class="form-control" name="principal_name" id="editPrincipal">
          </div>
        </div>
        <div class="modal-footer">
          <button type="submit" class="btn btn-primary">Save Changes</button>
          <a href="#" id="deleteBtn" class="btn btn-outline-danger">Delete</a>
        </div>
      </form>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const modal = document.getElementById("editModal");
  const form = document.getElementById("editForm");
  const deleteBtn = document.getElementById("deleteBtn");

  modal.addEventListener("show.bs.modal", event => {
    const button = event.relatedTarget;
    const id = button.getAttribute("data-id");
    document.getElementById("editId").value = id;
    document.getElementById("editName").value = button.getAttribute("data-name");
    document.getElementById("editAddress").value = button.getAttribute("data-address");
    document.getElementById("editEmail").value = button.getAttribute("data-email");
    document.getElementById("editPhone").value = button.getAttribute("data-phone");
    document.getElementById("editOwner").value = button.getAttribute("data-owner");
    document.getElementById("editPrincipal").value = button.getAttribute("data-principal");

    form.action = `/superadmin/schools/edit/${id}/`;
    deleteBtn.href = `/superadmin/schools/delete/${id}/`;
  });
</script>

{% endblock %}






















<!-- Main Content -->
<div class="col-md-10 p-4">

  <h3 class="mb-4">Manage Schools</h3>

  {% if messages %}
    {% for message in messages %}
      <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
        {{ message }}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
      </div>
    {% endfor %}
  {% endif %}

  <!-- Add School Form -->
      <form method="post" action="" class="row g-3 mb-5">
  {% csrf_token %}

  <div class="col-md-4">
    <label class="form-label">Name</label>
    <input type="text" name="name" class="form-control" required>
  </div>

  <div class="col-md-4">
    <label class="form-label">Address</label>
    <input type="text" name="address" class="form-control" required>
  </div>

  <div class="col-md-4">
    <label class="form-label">Email</label>
    <input type="email" name="email" class="form-control">
  </div>

  <div class="col-md-4">
    <label class="form-label">Phone Number</label>
    <input type="text" name="phone_number" class="form-control">
  </div>

  <div class="col-md-4">
    <label class="form-label">Owner Name</label>
    <input type="text" name="owner_name" class="form-control">
  </div>

  <div class="col-md-4">
    <label class="form-label">Principal Name</label>
    <input type="text" name="principal_name" class="form-control">
  </div>

  <div class="col-12">
    <button type="submit" class="btn btn-success w-100 mt-2">Add School</button>
  </div>
</form>


  <!-- Existing Schools Table -->
  <table class="table table-bordered">
    <thead class="table-light">
      <tr>
        <th>Name</th>
        <th>Address</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for school in schools %}
        <tr>
          <td>{{ school.name }}</td>
          <td>{{ school.address }}</td>
          <td>
            <button class="btn btn-sm btn-outline-primary edit-btn" 
                  data-bs-toggle="modal" 
                  data-bs-target="#editModal"
                  data-id="{{ school.id }}"
                  data-name="{{ school.name }}"
                  data-address="{{ school.address }}"
                  data-email="{{ school.email }}"
                  data-phone="{{ school.phone_number }}"
                  data-owner="{{ school.owner_name }}"
                  data-principal="{{ school.principal_name }}">
            Edit
          </button>

          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

<!-- Edit Modal -->
<div class="modal fade" id="editModal" tabindex="-1">
  <div class="modal-dialog">
    <div class="modal-content">
      <form method="post" id="editForm">
        {% csrf_token %}
        <div class="modal-header">
          <h5 class="modal-title">Edit School</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body">
          <input type="hidden" name="school_id" id="editId">

          <div class="mb-3">
            <label class="form-label">Name</label>
            <input type="text" class="form-control" name="name" id="editName" required>
          </div>

          <div class="mb-3">
            <label class="form-label">Address</label>
            <textarea class="form-control" name="address" id="editAddress" required></textarea>
          </div>

          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email" class="form-control" name="email" id="editEmail">
          </div>

          <div class="mb-3">
            <label class="form-label">Phone Number</label>
            <input type="text" class="form-control" name="phone_number" id="editPhone">
          </div>

          <div class="mb-3">
            <label class="form-label">Owner Name</label>
            <input type="text" class="form-control" name="owner_name" id="editOwner">
          </div>

          <div class="mb-3">
            <label class="form-label">Principal Name</label>
            <input type="text" class="form-control" name="principal_name" id="editPrincipal">
          </div>
        </div>

        <div class="modal-footer">
          <button type="submit" class="btn btn-success">Save Changes</button>
         <a href="#" id="deleteBtn" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this school?')">Delete</a>

        </div>
      </form>
    </div>
  </div>
</div>


<!-- <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script>
  const modal = document.getElementById("editModal");
  const form = document.getElementById("editForm");
  const deleteBtn = document.getElementById("deleteBtn");

  modal.addEventListener("show.bs.modal", event => {
  const button = event.relatedTarget;
  const id = button.getAttribute("data-id");

  document.getElementById("editId").value = id;
  document.getElementById("editName").value = button.getAttribute("data-name");
  document.getElementById("editAddress").value = button.getAttribute("data-address");
  document.getElementById("editEmail").value = button.getAttribute("data-email");
  document.getElementById("editPhone").value = button.getAttribute("data-phone");
  document.getElementById("editOwner").value = button.getAttribute("data-owner");
  document.getElementById("editPrincipal").value = button.getAttribute("data-principal");

  form.action = `/superadmin/schools/edit/${id}/`;
  deleteBtn.href = `/superadmin/schools/delete/${id}/`;

  });
</script> -->


